<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xin Chào</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="<%= mainCssUrl %>">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function changeAvatar(event) {
            let avatar_preview_el = document.getElementById("avatar_preview");
            if (event.target.files.length != 0) {
                let blodLink = URL.createObjectURL(event.target.files[0]);
                avatar_preview_el.src=blodLink;
            }
        }

        function deleteStudent(studentId) {
            if(!confirm("Xóa ok?")) {
                return
            }
            fetch("http://localhost:3000/apis/v1/students/" + studentId, {
                method: "delete", 
            }).then(res => {
                window.location.reload();
            })
        }
    </script>
</head>
<body>
    <section class="body_container">
        <h1 style="text-align: center;">STUDENT MANAGE</h1>
        <%- include('studentForm', {form: {submitTitle: "Tạo Mới", actionUrl: "http://localhost:3000/apis/v1/students"}}); %>
        <table class="table">
            <thead>
              <tr>
                <th scope="col">
                    <div class="content">
                        #
                    </div>
                </th>
                <th scope="col">
                    <div class="content">
                        Name
                    </div>
                </th>
                <th scope="col">
                    <div class="content">
                        Age
                    </div> 
                </th>
                <th scope="col">
                    <div class="content">
                        Avatar
                    </div>
                </th>
                <th scope="col">
                    <div class="content">
                        Class
                    </div>
                </th>
              </tr>
            </thead>
            <tbody>
                <% students.forEach(function(student, index){ %>
                    <tr>
                        <th scope="row">
                            <div class="content">
                                <%= index + 1 %>
                            </div>
                        </th>
                        <td>
                            <div class="content">
                                <%= student.name %>
                            </div>
                        </td>
                        <td>
                            <div class="content">
                                <%= student.age %>
                            </div>
                        </td>
                        <td>
                            <div class="content">
                                <img src="http://localhost:3000/<%= student.avatar %>" style="width: 50px; height: 50px; border-radius: 50%;">
                            </div>
                        </td>
                        <td>
                            <div class="content">
                                <%= student.class %>
                            </div>
                        </td>
                        <td>
                            <div onclick="deleteStudent('<%= student.id %>')" style="cursor: pointer; font-weight: 900; color: red;" class="content">
                                X
                            </div>
                        </td>
                      </tr>
                <% }); %>
            </tbody>
          </table>
    </section>
</body>
</html>